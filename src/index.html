<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameHub - CrazyGames Clone</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="setting.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    
    <!-- Auth Container (will be populated by JavaScript) -->
    <div id="auth-container" class="auth-container"></div>

    <div class="container">
        <!-- Pinned Games Row (initially hidden) -->
        <div class="game-row pinned-games-row" style="display: none;">
            <h3 class="row-title">
                <i class='bx bxs-bookmark-alt'></i> Favorite Games
                <span class="clear-pins" title="Clear all favorite games">
                    <i class='bx bx-trash'></i>
                </span>
            </h3>
            <div class="game-scroll-container">
                <div class="horizontal-game-grid" id="pinnedGamesContainer"></div>
            </div>
        </div>

        <!-- Search Bar -->
        <div class="search-container">
            <i class='bx bx-search'></i>
            <input type="text" id="searchInput" placeholder="Search games...">
        </div>

        <!-- Horizontal Category Tabs -->
        <div class="category-tabs">
            <button class="tab-btn active" data-category="all">
                <i class='bx bx-game'></i> All Games
            </button>
            <button class="tab-btn" data-category="action">
                <i class='bx bx-run'></i> Action
            </button>
            <button class="tab-btn" data-category="puzzle">
                <i class='bx bx-puzzle'></i> Puzzle
            </button>
            <button class="tab-btn" data-category="sports">
                <i class='bx bx-football'></i> Sports
            </button>
            <button class="tab-btn" data-category="io">
                <i class='bx bx-globe'></i> .IO
            </button>
        </div>

        <!-- Game Rows Container -->
        <div class="games-rows-container" id="gamesContainer">
            <!-- Rows will be generated by JavaScript -->
        </div>
    </div>

    <!-- Hamburger Menu -->
    <button class="hamburger">
        <i class='bx bx-menu'></i>
    </button>

    <!-- Vertical Navbar -->
    <nav class="navbar closed">
        <div class="nav-container">
            <a href="#" class="nav-link" data-glow-color="#4fc3f7">
                <i class='bx bx-home'></i>
            </a>
            <a href="#" class="nav-link" data-glow-color="#ff6e40">
                <i class='bx bx-search'></i>
            </a>
            <a href="#" class="nav-link" data-glow-color="#9575cd">
                <i class='bx bx-heart'></i>
            </a>
            <a href="settings.html" class="nav-link" data-glow-color="#64dd17">
                <i class='bx bx-user'></i>
            </a>
            <a href="settings.html" class="nav-link" data-glow-color="#ffd600">
                <i class='bx bx-cog'></i>
            </a>
            <div class="glow-effect"></div>
        </div>
    </nav>

    <script src="script.js"></script>
    <script src="setting.js"></script>
    <script src="q50.js"></script>
</body>
</html>

<script>
// Firebase Configuration
const firebaseConfig = {
  apiKey: "AIzaSyADCVIINCBgvTBvClWqWI5o3SlVS47IJnw",
  authDomain: "fusioncya-cc20a.firebaseapp.com",
  databaseURL: "https://fusioncya-cc20a-default-rtdb.firebaseio.com",
  projectId: "fusioncya-cc20a",
  storageBucket: "fusioncya-cc20a.appspot.com",
  messagingSenderId: "765164293111",
  appId: "1:765164293111:web:43e051c755c4690c0c3cf2",
  measurementId: "G-4DT52P7MPB"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Sync settings between pages
document.addEventListener('DOMContentLoaded', function() {
  // Apply saved settings immediately
  applyLocalSettings();
  
  // Set up auth state listener
  auth.onAuthStateChanged(user => {
    if (user) {
      // Load settings from Firestore for logged-in users
      db.collection('users').doc(user.uid).get()
        .then(doc => {
          if (doc.exists) applySettings(doc.data().settings || {});
        });
    } else {
      // Apply local settings for guests
      applyLocalSettings();
    }
  });

  // Sync across tabs
  window.addEventListener('storage', handleStorageEvent);
});

function applySettings(settings) {
  // Theme
  if (settings.theme) {
    document.body.className = settings.theme;
    localStorage.setItem('theme', settings.theme);
  }
  
  // Background Image
  if (settings.backgroundImage) {
    document.body.style.backgroundImage = `url(${settings.backgroundImage})`;
    localStorage.setItem('backgroundImage', settings.backgroundImage);
  } else {
    document.body.style.backgroundImage = 'none';
    localStorage.removeItem('backgroundImage');
  }
  
  // Particles
  if (settings.particlesEnabled) {
    localStorage.setItem('particlesEnabled', 'true');
    initParticles();
  } else {
    localStorage.setItem('particlesEnabled', 'false');
    destroyParticles();
  }
  
  // Panic Key
  if (settings.panicKey && settings.panicUrl) {
    localStorage.setItem('panicKey', settings.panicKey);
    localStorage.setItem('panicUrl', settings.panicUrl);
    setupPanicKey();
  }
}

function applyLocalSettings() {
  // Theme
  const theme = localStorage.getItem('theme');
  if (theme) document.body.className = theme;
  
  // Background Image
  const bgImage = localStorage.getItem('backgroundImage');
  if (bgImage) {
    document.body.style.backgroundImage = `url(${bgImage})`;
  }
  
  // Particles
  if (localStorage.getItem('particlesEnabled') === 'true') {
    initParticles();
  }
  
  // Panic Key
  if (localStorage.getItem('panicKey') && localStorage.getItem('panicUrl')) {
    setupPanicKey();
  }
}

function handleStorageEvent(event) {
  switch(event.key) {
    case 'theme':
      document.body.className = event.newValue || '';
      break;
      
    case 'backgroundImage':
      if (event.newValue) {
        document.body.style.backgroundImage = `url(${event.newValue})`;
      } else {
        document.body.style.backgroundImage = 'none';
      }
      break;
      
    case 'particlesEnabled':
      if (event.newValue === 'true') {
        initParticles();
      } else {
        destroyParticles();
      }
      break;
      
    case 'panicKey':
    case 'panicUrl':
      setupPanicKey();
      break;
  }
}

function setupPanicKey() {
  const panicKey = localStorage.getItem('panicKey');
  const panicUrl = localStorage.getItem('panicUrl');
  
  // Remove old listener if exists
  if (window.panicKeyListener) {
    document.removeEventListener('keydown', window.panicKeyListener);
  }
  
  if (panicKey && panicUrl) {
    window.panicKeyListener = function(e) {
      if (e.key === panicKey) window.location.href = panicUrl;
    };
    document.addEventListener('keydown', window.panicKeyListener);
  }
}

// Basic particle system for demonstration
function initParticles() {
  console.log("Particles enabled");
  // Your particle implementation here
}

function destroyParticles() {
  console.log("Particles disabled");
  // Clean up particles
}
</script>

<script src="setting.js"></script>
