<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameHub - CrazyGames Clone</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="setting.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- Navigation Sidebar -->
    <nav id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <button id="sidebarToggle" class="sidebar-toggle">
                <i class='bx bx-x'></i>
            </button>
        </div>
        <ul class="sidebar-menu">
            <li><a href="index.html"><i class='bx bx-home'></i> Home</a></li>
            <li><a href="settings.html"><i class='bx bx-cog'></i> Settings</a></li>
            <li><a href="profile.html"><i class='bx bx-user'></i> Profile</a></li>
            <li class="divider"></li>
            <li>
                <button id="aboutBlankBtn" class="about-blank-btn">
                    <i class='bx bx-shield'></i> About Blank
                </button>
            </li>
        </ul>
        <div class="sidebar-footer">
            <div class="user-info-small">
                <img id="sidebar-profile-pic" src="https://via.placeholder.com/40" alt="Profile" class="profile-pic-small">
                <span id="sidebar-username">Guest</span>
            </div>
        </div>
    </nav>

    <!-- Main Header -->
    <header>
        <button id="sidebarToggleMobile" class="sidebar-toggle mobile">
            <i class='bx bx-menu'></i>
        </button>
        <h1 class="logo">GameHub</h1>
        <div class="user-info">
            <span id="username-display">Guest</span>
            <div id="profile-pic-container">
                <img id="profile-pic" src="https://via.placeholder.com/40" alt="Profile" class="profile-pic">
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Pinned Games Row -->
        <div class="game-row pinned-games-row" style="display: none;">
            <h3 class="row-title">
                <i class='bx bxs-bookmark-alt'></i> Favorite Games
                <span class="clear-pins" title="Clear all favorite games">
                    <i class='bx bx-trash'></i>
                </span>
            </h3>
            <div class="game-scroll-container">
                <div class="horizontal-game-grid" id="pinnedGamesContainer"></div>
            </div>
        </div>

        <!-- Search Bar -->
        <div class="search-container">
            <i class='bx bx-search'></i>
            <input type="text" id="searchInput" placeholder="Search games...">
        </div>

        <!-- Category Tabs -->
        <div class="category-tabs">
            <button class="tab-btn active" data-category="all">
                <i class='bx bx-game'></i> All Games
            </button>
            <button class="tab-btn" data-category="action">
                <i class='bx bx-run'></i> Action
            </button>
            <button class="tab-btn" data-category="puzzle">
                <i class='bx bx-puzzle'></i> Puzzle
            </button>
            <button class="tab-btn" data-category="sports">
                <i class='bx bx-football'></i> Sports
            </button>
            <button class="tab-btn" data-category="io">
                <i class='bx bx-globe'></i> .IO
            </button>
        </div>

        <!-- Game Rows Container -->
        <div class="games-rows-container" id="gamesContainer">
            <!-- Rows will be generated by JavaScript -->
        </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <h3>Sign In Required</h3>
            <p>Please sign in to access all features.</p>
            <div class="modal-actions">
                <button id="go-to-login" class="btn">Sign In</button>
                <button id="continue-guest" class="btn btn-secondary">Continue as Guest</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="setting.js"></script>
    
    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyADCVIINCBgvTBvClWqWI5o3SlVS47IJnw",
            authDomain: "fusioncya-cc20a.firebaseapp.com",
            databaseURL: "https://fusioncya-cc20a-default-rtdb.firebaseio.com",
            projectId: "fusioncya-cc20a",
            storageBucket: "fusioncya-cc20a.appspot.com",
            messagingSenderId: "765164293111",
            appId: "1:765164293111:web:43e051c755c4690c0c3cf2",
            measurementId: "G-4DT52P7MPB"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Load theme immediately when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            // Apply saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.body.className = savedTheme;
            }
            
            // Initialize auth state listener
            auth.onAuthStateChanged(handleAuthStateChange);
            
            // Force games to load on initial page load
            setTimeout(() => {
                const allGamesBtn = document.querySelector('.tab-btn[data-category="all"]');
                if (allGamesBtn) allGamesBtn.click();
            }, 100);
        });

        function handleAuthStateChange(user) {
            if (user) {
                document.getElementById('username-display').textContent = user.displayName || 'User';
                document.getElementById('sidebar-username').textContent = user.displayName || 'User';
                
                if (user.photoURL) {
                    document.getElementById('profile-pic').src = user.photoURL;
                    document.getElementById('sidebar-profile-pic').src = user.photoURL;
                }
                
                document.getElementById('login-modal').classList.remove('active');
            } else {
                document.getElementById('username-display').textContent = 'Guest';
                document.getElementById('sidebar-username').textContent = 'Guest';
                document.getElementById('profile-pic').src = 'https://via.placeholder.com/40';
                document.getElementById('sidebar-profile-pic').src = 'https://via.placeholder.com/40';
            }
        }
    </script>
</body>
</html>
